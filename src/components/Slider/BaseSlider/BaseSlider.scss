@use '../../variables';

@mixin slider-outer-style($slider-size, $rail-size, $line-height, $mark-offset) {
    $common-padding: calc(($slider-size - $rail-size) / 2);
    $bottom-padding: calc($common-padding + $line-height - $mark-offset);
    padding: $common-padding 0 $bottom-padding;
    height: calc($common-padding + $rail-size + $bottom-padding);
    margin: 0 calc($slider-size / 2);
}

$block: '.#{variables.$ns-new}base-slider';

#{$block} {
    $slider-color: var(--g-color-base-brand);
    $slider-rail-color: var(--g-color-base-selection); //--g-color-base-info-light in figma
    $slider-unfilled-tail-color: var(--g-color-base-background);
    $slider-color-error: var(--g-color-base-danger-heavy);

    $slider-rail-disabled-color: var(--g-color-base-generic-accent-disabled);
    $slider-handle-disabled-color: var(
        --g-color-base-generic-accent
    ); // --g-color-misc-axis in figma

    $slider-handle-focus-color: var(
        --g-color-base-selection-hover
    ); // --g-color-base-info-light-hover in figma

    $slider-handle-focus-error-color: var(
        --g-color-base-danger-light-hover
    ); // not presented in figma

    $slider-s-size: 15px; //14 in figma
    $slider-m-size: 18px;
    $slider-l-size: 21px; //20 in figma
    $slider-xl-size: 24px;

    $rail-s-size: 3px;
    $rail-m-size: 4px;
    $rail-l-size: 5px;
    $rail-xl-size: 6px;

    $mark: '#{$block}-mark';

    $mark-s-offset: 1px;
    $mark-m-offset: 1px;
    $mark-l-offset: -5px;
    $mark-xl-offset: -9px;

    * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    position: relative;
    width: 100%;
    touch-action: none;
    box-sizing: border-box;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);

    &_size {
        $line-height: var(--g-text-body-1-line-height);

        &_s {
            @include slider-outer-style(
                #{$slider-s-size},
                #{$rail-s-size},
                #{$line-height},
                #{$mark-s-offset}
            );

            #{$mark} {
                font-size: var(--g-text-body-1-font-size);
                line-height: #{$line-height};

                $edge-mark-offset: calc(-#{$slider-s-size} / 2);

                &-text:last-of-type {
                    right: #{$edge-mark-offset};
                }

                &-text:first-of-type {
                    //we override last of type style in the situation when we have only one mark
                    //so we should have this style sequence
                    right: unset;
                    left: #{$edge-mark-offset};
                }
            }
        }

        &_m {
            @include slider-outer-style(
                #{$slider-m-size},
                #{$rail-m-size},
                #{$line-height},
                #{$mark-m-offset}
            );

            #{$mark} {
                font-size: var(--g-text-body-1-font-size);
                line-height: #{$line-height};

                $edge-mark-offset: calc(-#{$slider-m-size} / 2);

                &-text:last-of-type {
                    right: #{$edge-mark-offset};
                }

                &-text:first-of-type {
                    //we override last of type style in the situation when we have only one mark
                    //so we should have this style sequence
                    right: unset;
                    left: #{$edge-mark-offset};
                }
            }
        }

        &_l {
            @include slider-outer-style(
                #{$slider-l-size},
                #{$rail-l-size},
                #{$line-height},
                #{$mark-l-offset}
            );

            #{$mark} {
                font-size: var(--g-text-body-1-font-size);
                line-height: #{$line-height};

                $edge-mark-offset: calc(-#{$slider-l-size} / 2);

                &-text:last-of-type {
                    right: #{$edge-mark-offset};
                }

                &-text:first-of-type {
                    //we override last of type style in the situation when we have only one mark
                    //so we should have this style sequence
                    right: unset;
                    left: #{$edge-mark-offset};
                }
            }
        }

        &_xl {
            $line-height: var(--g-text-body-2-line-height);

            @include slider-outer-style(
                #{$slider-xl-size},
                #{$rail-xl-size},
                #{$line-height},
                #{$mark-xl-offset}
            );

            #{$mark} {
                font-size: var(--g-text-body-2-font-size);
                line-height: #{$line-height};

                $edge-mark-offset: calc(-#{$slider-xl-size} / 2);

                &-text:last-of-type {
                    right: #{$edge-mark-offset};
                }

                &-text:first-of-type {
                    //we override last of type style in the situation when we have only one mark
                    //so we should have this style sequence
                    right: unset;
                    left: #{$edge-mark-offset};
                }
            }
        }
    }

    &__rail {
        position: absolute;
        width: 100%;
        border-radius: 4px;
        background-color: #{$slider-rail-color};
        &_size {
            &_s {
                height: #{$rail-s-size};
            }

            &_m {
                height: #{$rail-m-size};
            }

            &_l {
                height: #{$rail-l-size};
            }

            &_xl {
                height: #{$rail-xl-size};
            }
        }

        &_disabled {
            background-color: #{$slider-rail-disabled-color};
        }

        &_error {
            background-color: #{$slider-color-error};
        }
    }

    &__track {
        position: absolute;
        border-radius: 4px;
        background-color: #{$slider-color};
        &_size {
            &_s {
                height: #{$rail-s-size};
            }

            &_m {
                height: #{$rail-m-size};
            }

            &_l {
                height: #{$rail-l-size};
            }

            &_xl {
                height: #{$rail-xl-size};
            }
        }
        &_disabled,
        &_error {
            visibility: hidden;
        }
    }

    &__handle {
        position: absolute;
        z-index: 1;
        cursor: grab;
        cursor: grab;
        touch-action: pan-x;
        background-color: #{$slider-unfilled-tail-color};
        border-radius: 50%;
        border-style: solid;
        border-color: #{$slider-color};
        top: 0;

        &_size {
            &_s {
                height: #{$slider-s-size};
                width: #{$slider-s-size};
                border-width: 4px;
            }

            &_m {
                height: #{$slider-m-size};
                width: #{$slider-m-size};
                border-width: 5px;
            }

            &_l {
                height: #{$slider-l-size};
                width: #{$slider-l-size};
                border-width: 5px;
            }

            &_xl {
                height: #{$slider-xl-size};
                width: #{$slider-xl-size};
                border-width: 6px;
            }
        }

        &:active {
            box-shadow: 0 0 4px #{$slider-color};
            cursor: grabbing;
        }

        &:focus {
            box-shadow: 0 0 0 4px #{$slider-handle-focus-color};
            outline: none;
        }

        &_disabled {
            cursor: not-allowed;
            border-color: #{$slider-handle-disabled-color};

            &:active,
            &:focus {
                cursor: not-allowed;
                box-shadow: none;
            }
        }

        &_error {
            border-color: #{$slider-color-error};
            &:active,
            &:focus {
                box-shadow: 0 0 0 4px var(--g-color-base-danger-light-hover);
            }
        }
    }

    &__step {
        position: absolute;
        width: 100%;
        background: transparent;

        &_size {
            &_s {
                height: #{$rail-s-size};
            }

            &_m {
                height: #{$rail-m-size};
            }

            &_l {
                height: #{$rail-l-size};
            }

            &_xl {
                height: #{$rail-xl-size};
            }
        }
    }

    #{$mark} {
        position: absolute;
        left: 0;
        width: 100%;
        color: var(--g-color-text-secondary);
        bottom: 0;
    }

    &-mark-text {
        position: absolute;
        display: inline-block;
        text-align: center;
        vertical-align: middle;
        cursor: pointer;
        bottom: 0;
    }

    &-dot {
        display: none;
    }
}
